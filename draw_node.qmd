---
title: "Device Connectivity Report"
author: "Terry Doner"
date: last-modified
date-format: "[Last Updated on] MMMM DD YYYY"
format:
  html:
    toc: true
    number-sections: true
    css: styles.css
  pdf:
    number-sections: true 
    toc: true
    toc-depth: 2
always_allow_html: yes
editor: visual
execute: 
  eval: TRUE
  echo: false
  warning: false
  message: false
---

```{r}
#target<- c("2308-0002", "2308-0003" , "CDWU-A002" )
 target <- c(  "CDMU-A001",   "2308-0808")
#target <- "ZVIU-A004"
#target <- c("ZVKU-A001", "ZVIU-A001", "ZVIU-A002",
#			"ZVIU-B001", "ZVIU-A005")

daw <- c('2308-1100'
		, '2308-1101'
		, '2308-1102'
		, '2308-1103'
		, '2308-1104'
		, '2308-1105'
		, '2308-1106'
		, '2308-1107'
		, '2308-1110')
target <- daw
```

This report provides the details for these devices `r target` and the devices connected to them (it).

```{r packages_functions, eval=TRUE}
source('commonPackages.R')
source('commonFunctions.R')
source('commonDiagram.R')
```

```{r get_data}
inventory <- get.inventory() #; nrow(inventory)
cables <- get.cables()
```

```{r calc_targets}
target_cables <- cables |>
	filter(SrcTag %in% target | DstTag %in% target)  

target_devices <- c(target_cables$SrcTag ,
	target_cables$DstTag ,
	target )
```
 
# Diagram

```{r }
get_diagram(target , inventory, cables)
``` 
 
# Connected Neighbours

```{r gt_inventory}
inventory |>
	filter(AssetTag %in%  target_devices) |>
	filter(!is.na(AssetTag)) |>
	select(AssetTag, Manufacturer, Model, Desc) |>
	gt() |>
			opt_stylize(style = 3) |>
	tab_header( glue("Connected neighbours of {paste(target, collapse=', ')}")
			  , subtitle = "They are highlighted in yellow"
			  ) |>
    tab_style(  
      
      style = list(  cell_fill(color = "yellow")  ),
      locations = cells_body(columns = AssetTag,
      					     rows = AssetTag %in% target   )
	) |>
	tab_style(
		style=list( cell_text(weight = "bold") ),
		locations=cells_body(columns=AssetTag)
	)
```
 
# Cables

```{r gt_cables}
target_cables |>
	select(Tag,SrcTag,SrcPort,DstTag,DstPort,Type,Length,`Labelled?`,Notes) |>
	gt() |>
			opt_stylize(style = 3) |>
	tab_header( glue("Cables connected to {paste(target, collapse=', ')}") 
			  , subtitle = "They are highlighted in yellow"
			   ) |>
    tab_style(
      style = list(
        cell_fill(color = "yellow")
        ),
      locations = cells_body(
        columns = SrcTag ,
        rows = SrcTag %in% target
    )
  )|>
    tab_style(
      style = list(
        cell_fill(color = "yellow") 
        ),
      locations = cells_body(
        columns = DstTag ,
        rows = DstTag %in% target
    )
  ) |>
	tab_style(
		style=list( cell_text(weight = "bold") ),
		locations=cells_body(columns=Tag)
	)  
```
