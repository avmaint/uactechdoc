---
title: "System Design - Audio"
author: "Terry Doner"
date: "`r format(Sys.time(), '%B %d %Y')`"
output:
  html_document:
    toc: yes
  pdf_document:
    toc: yes
---
```{r options, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message=FALSE)
options(knitr.table.format = "html") # latex for pdf 
```

```{r setup}
require(readr)
require(dplyr)
require(readxl)
require(knitr)
require(formattable)
require(kableExtra)
```

```{r functions}
source("commonFunctions.R")
```

```{r getdata}
NetworkInventory <- get.network()
Tech_Inventory <- get.inventory()
```

# Introduction
This document provides key technical documentation for the Santurary audio subsystems at UAC. Other audio systems are not documeted to this level of detail (Youth, Children).

Purpose:

* Necessary to help the hearing impaired ( roughly 10% of the population) to lip read
* Supports video recording
* Helps draw attention to the central item â€“ conversely makes it easier to ignore clutter
* Helps audience to focus and concentrate
* Reinforces the message (spoken or sung)

[Back to top](#top)
 
# Configuration
The descriptions of the configurations will generally start at the input side of the system and work towards the outputs.

```{r overview}
DiagrammeR::grViz("sda-overview.gv")
```

[Back to top](#top)
 
##Inputs

There are a variety of microphone inputs that come from the stage as well as CD players, tape players and computer inputs in the balcony. These all are fed into one of two audio mix consoles: A Yamaha M7CL-48 and a Yamaha DM1000. The M7CL is the primary console while the DM1000 handles inputs located at the mix position.

>TODO: Consider refactoring this diagram by console. That is a diagram for the DM1k and a diagram for the M7CL.

```{r inputdia}
DiagrammeR::grViz("sda-inputs.gv" )
```
  
### M7CL Input Assignments

Having a consistent wiring plan helps make system more predictable and easier for all audio engineers to use. The consistent wiring plan is also essentail to leveage the power of console's scene recall feature. It minimizies the amount of rewiring required.

This is the standard input map for the M7.

|Ch #	|Input |	Mic/DI	| Notes |
|------|------|------|------|
|1|Kick|Beyer M88|Drum Snake|
|2|Snare|CAD|Drum Snake|
|3|Tom 1|CAD|Drum Snake|
|4|Tom 2|CAD|Drum Snake|
|5|Tom 3|CAD|Drum Snake|
|6|Tom 4 (floor)|CAD|Drum Snake|
|7|OH L|AKG 418|Drum Snake|
|8|OH R|AKG 418|Drum Snake|
|9|Hat|AKG 418|Drum Snake|
|10|Djembe - spare (Sn 2)|SM 57|Drum Snake|
|11|perc 1||Drum Snake|
|12|perc 2||Drum Snake|
|13|Bass 1|JDI DI||
|14|Bass 2|||
|15|EG 1|SM 57||
|16|EG 2|||
|17|AG 1|Pro DI||
|18|AG 2|||
|19|B3 lo| SM57 ||
|20|B3 hi| SM57 ||
|21|Pno lo|||
|22|Pno hi|||
|23|syn 1|Pro DI||
|24|syn 2|||
|25|syn 3|||
|26|syn 4|||
|27|Str 1|||
|28|Str 2|||
|29|Choir 1|AT 853|Set up as required|
|30|Choir 2|AT 853|Set up as required|
|31|Choir 3|AT 853|Set up as required|
|32|Choir 4|||
|33|LVox 1|Beta 58|Vocal Snake|
|34|LVox 2|Beta 58|Vocal Snake|
|35|LVox 3|Beta 58|Vocal Snake|
|36|LVox 4|Beta 58|Vocal Snake|
|37|LVox 5|Beta 58|Vocal Snake|
|38|LVox 6|Beta 58|Vocal Snake|
|39|LVox 7|Beta 58|Vocal Snake|
|40|LVox 8|Beta 58|Vocal Snake|
|41|Hn 1|AKG 419 or SM 57||
|42|Hn 2|AKG 419 or SM 57||
|43|unused| | |
|44|unused| | |
|45|unused| | |
|46|unused| | |
|47|unused| | |
|48|unused| | |
|STR1|Effect 1 Return|Rev Plate|stereo inputs|
|STR2|Effect 2 Return|Rev Hall||
|STR3|Effect 3 Return|Mono Delay||
|STR4|Effect 4 Return|Chorus||
|||||

>TODO: Later in 2018 we will be adding additional Wireless Handhelds. These will likely occupy channels 33-42. The wired vocals will move to channels 43-48. We will also be adding DANTE based routing options, with the addtional of a dante interface card in each of the DM1K and thr M7CL.

### DM1000 Inputs
THe DM1000 inputs are all located in the FoH mix position. 

|Ch #|Input|Mic/DI|Notes|
|----|----|----|----|
|1|HH 1|Shure|Wireless|
|2|HH 2|Shure|Wireless|
|3|Lav 1|Shure|Wireless|
|4|Lav 2|Shure|Wireless|
|5|unused| | |
|6|unused| | |
|7|unused| | |
|8|unused| | |
|9|unused| | |
|10|unused| | |
|11|CD L||Tascam CD-01U|
|12|CD R||Tascam CD-01U|
|13|Comp L|||
|14|Comp R|||
|15|DVD/Laptop/ipod L|||
|16|DVD/Laptop/ipod R|||
|Omni 1|VCR L|Fader 29||
|Omni 2|VCR R|Fader 30||
|Omni 3|Cass L|Fader 31||
|Omni 4|Cass R|Fader 32||
| | | | |

>TODO: Later in 2018 we will be adding additonal wirless beltpacks. These will occupy channels 1-6. We will also be adding DANTE based routing options, with the addtional of a dante interface card in each of the DM1K and thr M7CL.   

```{r top1}
print_inv(c( "CDMU-A001", "ZAKU-0002",
             "ZAKU-0001", "ZAMU-A001", "ZAPU-0001" ), Tech_Inventory)
```

[Back to top](#top)
 
##Front of House

###Consoles

As introduced in the earlier section there are two primary mix consoles in the Santurary System. Both of these consoles are digital with full scene store and recall. Recalling scene 001 on the M7CL will cause both consoles to reset to our standard starting point which is an excellent foundation for 95% of the services we run in a year. 

The DM1000 (sometimes referred to as DM1K) is the secondary console which colelcts the inputs for most of the FOH located gear: players, computers, and some of the wireless receivers. It in turn supplies audio to the main console via bus level links (via IO cards on each console). 

The M7CL is the primary mixing consol for vocal and instrumentals. The outputs from this console drive the house, lobby and monitor speakers.

There are some additional outboard components which complete the signal path. The main house output flows through a TC Electronics Finalizer, which provides multi-band compression. The output of that then goes two directions. one channel feeds the audio recording subsystem and the other feeds into the FOH DSP- and BSS soundweb.

The monitor amps are feed directly from the M7CL. The house amps are feed from the soundweb.

```{r fohdia}
DiagrammeR::grViz("sda-foh.gv" )
```

###Other FoH gear


>TODO: write content

### Console Links
There is an IO exapnsion card in each of the two consoles. This enables console-to-console communication. The busses in the DM1000 console are linked to the busses in the M7 using these cards. The FLow is from the DM1000 to the M7. The link cards are in slot one of each console.

There is also a midi link between the two which enables synchronized scene recall.

```{r linkdia}
DiagrammeR::grViz("sda-links.gv" )
```

#### DM1K Slot 1 Ouput Assignments

| Bus     | \ | Usage |
|-----------|-|-------------|
| Aux 1-6   | | Monitor 1-6 |
| Aux 8     | | Record      |
| Aux 15-16 | | Stereo LR   |
|           | |             |

#### M7CL Slot 1 Input Assignments

| Input | \ | Bus Assignment |
|-----------|-|-------------|
| 1-6   |   | Mix 1-6       |
| 8     |   | Mix 14        |
| 13-14 |   | Cue LR        |
| 15-16 |   | Stereo LR     |
| 16    |   | Mono          |
|           | |             |


### M7 Mix Bus Usage

This console has 16 mix busses. Since the console is capable of multuple routing paths within the console. This is described by the 'And then' description which informs about what happens next within the console.

|Mix #|Description|And then|
|------|----------|----------|
|1|Monitor 1|To Rack EQ and then out to Omni 1|
|2|Monitor 2|To Rack EQ and then out to Omni 2|
|3|Monitor 3|To Rack EQ and then out to Omni 3|
|4|Monitor 4|To Rack EQ and then out to Omni 4|
|5|Monitor 5|To Rack EQ and then out to Omni 5|
|6|Monitor 6|To Rack EQ and then out to Omni 6|
|7|Effect - Reverb plate|To Rack 5 and then to STRIN 1|
|8|Effect - Rev-X Hall|To Rack 6 and then to STRIN 2|
|9|Effect - mono Delay|To Rack 7 and then to STRIN 3|
|10|Effect - Chorus|To Rack 8 and then to STRIN 4|
|11|||
|12|||
|13|||
|14|Record Mix|Out on Omni 14|
|15|||
|16|||
||||

### M7 User Defined Key

The user defined keys allow the operator to quickly acccess common features.

|Key|Function|
|----|----|
|1|Monitor 1 to faders|
|2|Monitor 2 to faders|
|3|Monitor 3 to faders|
|4|Monitor 4 to faders|
|5|Monitor 5 to faders|
|6|Monitor 6 to faders|
|7|Fx1 to faders|
|8|Fx2 to faders|
|9|Record to faders|
|10|48v - phantom power control|
|11|Tap - effect timing|
|12|Talkback - operator to stage communication|
|||


[Back to top](#top)


## Amplifiers

Now lets finish our journey the the speakers.  

```{r outputs}
DiagrammeR::grViz("sda-outputs.gv")
```

```{r}
print_inv(c( "ZAKU-0001", "ZAKU-0002", "ZVKU-A003",
             "ZAHU-0001","ZAHU-0002","ZAHU-0005","ZAHU-0006"), Tech_Inventory)
```

##Speakers

>TODO: Write content

We have speakers in several locatoins:

* Main cluster for Front of House which is suspended in front of the stage.
* Monitor speakers on the stage floor
* FoH fill speakers above the balcony and underneath the balcony
* in the lobby ceiling

```{r}
cs <- c("ZASU-0001-0002",
"ZASU-0003-0005",
"ZASU-0006-0011",
"ZASU-0012-0019",
"ZASU-0020-0021")

print_inv(cs , Tech_Inventory)
```

[Back to top](#top)

# Network Details
Some of the audio system components have network (tcp/ip specicially) connectivity requriements. The primary audio console can be remotely operated from an iPad, so other devices also must be on the network as well, but they are personal devices and not part of this inventory. In the balcony, network switch NPHU-0004 provides wired access.    

```{r} 
 NetworkInventory %>% 
  filter(Category=="Audio") %>% 
  select(Location, Usage, Device, MAC, IP, URL, Notes) %>%
  kable()  %>%
    kable_styling("striped", full_width = TRUE)
```

[Back to top](#top)

# Equipment Inventory

```{r inventory, echo=FALSE, asis=TRUE}

cs = c("AssetTag", "Qty"  ,
  "Manufacturer" ,
  "Model"  , 
  "Qty",
  "Location"  ,
  "Type" ,
  "Desc"     )

Tech_Inventory %>%  
          filter( Category=="Audio" , InService== "Y") %>%  
          dplyr::select(one_of(cs)) %>% 
          kable(   )   %>%
    kable_styling("striped", full_width = TRUE)
```

[Back to top](#top)

`r knit_child('FurtherInformation.Rmd', quiet=TRUE)`

[Back to top](#top)

# Document Source
This document is compiled by merging text and data together using rmarkdown. The source is found here `r getwd()` / `r knitr::current_input()`

#Change History

`r commit.log.html( knitr::current_input() )`