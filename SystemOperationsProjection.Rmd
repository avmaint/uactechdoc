---
title: "System Operations - Projection"
author: "Terry Doner"
date: "`r format(Sys.time(), '%B %d %Y')`"
output:
  html_document:
    toc: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
require(readr)
require(dplyr)
require(readxl)
require(knitr)
require(jpeg)
require(grid)
require(ggplot2)
require(kableExtra)

knitr::opts_chunk$set(echo = FALSE)
options(knitr.table.format = "html") # latex for pdf 

path <-"~/Documents/UACTech/SystemDocumentation"
inventoryfile <- "TechInventory.xlsx"

fname <- paste(path, inventoryfile, sep="/")

NetworkInventory <- read_excel(fname, sheet = "Network")
```

# Introduction
This document provides basic operating information for each the video projection systems at Unionville Alliance Church.

Our projection system is quite flexible and allows for numerous video sources to be connected many display devices (including projectors and TVs).

ProPresenter is the primary tool we use for display Lyrics, message support graphics, announcements and other such visuals. The ProPresenter visuals are also used to broadcast and record our services, which is managed by the video crew.

At times you will also need to change the video routing for special features such as baptism. 

[Back to top](#top)

# ProPresenter Training Videos

The firm that makes ProPresenter has many great training videos on their [web site](https://www.renewedvision.com/propresenter.php?page=tour).

You are welcome to watch all of them, but I would highlight a few specifically to focus on:

* My first presentation
* Interface Overview
* All the ones on the “Working with Presentations” tab except “Working with Bibles” and “Live Video Input”.
* On the Beyond Slides , only “Planning Center Online” - This features really helps getting a service loaded into Propresenter fast. We may deal with "Importing and Exporting” eventually but I don’t think we will at the beginning.
* Finally on the Modules tab, only “Multi-screen enhancements”.

[Back to top](#top)

#How we Organize our files

>To be written

##Dropbox

## Dropbox ServiceFiles
ServiceFiles is meant for shorter term content and provide a means for content creators to contribute content remotely.

Dated groahics should go in Regular announcements if it is to be reused or the week specific folder, if it is for one week only. 

Week Specifc (eg. Feb12)
: Below ‘ServiceFIles’ there would be a folder like Feb-12. This is used for content that is specific to that week only. The powerpoint for the week, Announcement slides for that week, etc. Anything placed in those folders should be considered deleteable after the event has finished.  If it is to be reused for a few weeks, it can be copied to the next week. 

Announcements
: This folder is used for grphics we use all the time and has a an expiry date. Placing it here allows use to copy a script from one week to the next and also not be worried about deleting 'week specific' folders from prior weeks when we clean-up.

##Media Resources
>To be written


# Remote Login

Rather than having to come to the church to prepare the playlist, we offer the ability to login remotely. More than one person can do this at the same time which allows two people to see exactly the same thing and work together - this is helpful for training or assistance. 

To use the remote tool, you need to start with a web browser. Some work better than others. The preference is:

* Firefox
* Chrome (As of March 2018 there is a problem with the latest Chrome version)
* Internet Explorer / Safari. 

1. The address to get started is: https://remoteassist.neysh.ca/ . 
2. Click on "login" on the right side. 

!["Starting with the web page"](../../images/sop-remote-01.jpg)

3. You will be provided with a userid and password separately.
4. Please do your best to protect this password from being compromised. 
5. Click login

!["Logging into the Service"](../../images/sop-remote-02.jpg)

6. if you see uacAVtech here you know you are logged in to the service. 
7. click on "Host" 

!["Selecting the Host Tab" ](../../images/sop-remote-03.jpg)

8. Select this entry in the access list. 
9. There are several computers on the list, you want "CDMU-A001", click in the checkbox.
10. Then click "Join"

!["Selecting the Host Tab" ](../../images/sop-remote-04.jpg)

The first time in you will need to select one of these options which will install addtional components on your system. Try "Windows Selector" first (on a windows machin), otherwise "ClickOnceDirect" or "WebStartBootstrap".

!["Selecting the Correct Launcher" ](../../images/sop-remote-05.jpg)

Once logged into CDMU-A001 you will see all three displays that this computer has configured, you will want to use the view menu to select the primary display so you have a decent screen size to work with. 

[Back to top](#top)

# Preparing a ProPresenter Playlist
The playlist is the list of visual elements that we need to present during the service. It will follow very closely the cue sheet that comes from Planning Centre Online (PCO). 

There are two ways of doing this, the easiest way is to have ProPresenter create the playlist from PCO. They other way is to do it manually. Most of the time you will use the first option. 

Early in the week the service cue sheet for the following Sunday will be distributed. With that in hand you can prepare the playlist which includes all announcements, song lyrics, and other support elements. 

## Creating a Playlist from PCO

It is very rare that you won't create your playlist this way. After starting ProPresenter, find the "+" in the lowe left corner, and click on the little down arrow beside it. Select "New PCO Playlist".

!["Create a PCO Playlist" ](../../images/sop-NewPCOpl.jpg)

Next you will see a pop-up where you need to select the plan that you want to use for your playlist. You may need to scroll sideways to see the date.

>Need to add screen shots and more explanation.

If you created the playlist mid-week, you should refresh the playlist on Sunday morning to collect any updates. After doing a refresh check to make sure your arrangement choices haven't been changed.

>Insert screenshot

A PCO playlist is rigidly linked to PCO. You cannot add items or change the order. If you need to do that, you will need to convert the playlist to a regular playlist. 

>Insert screenshot.

[Back to top](#top)

# Importing Powerpoint

ProPresenter is able to import the contents of a Powerpoint presentation. It creates a document containing static images, which means any animations and transition affects that were part of the powerpoint are lost. You also need to ensure that any special fonts used in the powerpoint are installed on the system.

You execute the import via File > Import > Import from Powerpoint.

> Insert Screen shot

and then navigate to the powerpoint file. 

Once the import is complete, you can then link the new document to the playlist.

[Back to top](#top)

# Stage Display

[Back to top](#top)

# Video Loop Controls

The setting is a little hard to find when you ‘Link’ and video file directly to the playlist item. Here is how to do it.

By default when you add a video to ProPresenter it loops the video. Which is what you want for a motion background but not what you want for other content like a Announcement video.

How do you change it? Click on the little blue ‘i’ beside the playlist document. This will pop the media properties window. Click on the properties button and then the behaviour setting to ‘Stop’. If ‘Stop’ is not selectable then you need to change the ‘Media Cue Behaviour’ to ‘foreground’.

See the three yellow outlines in the image below.

!["Changing Video Loop Behaviour" ](../../images/sop_video_loop.jpg)
[Back to top](#top)

## Running Triple Wide

[Back to top](#top)

# Projectors  

## Turning the Front projectors On and Off

The projectors are operated using the remote controls. 

* The remotes for Front of House are in the black cabinet in the side storage room. Finding the right spot to stand to operate the projector requires a bit of practice. I find centre of the double door right under the exit sign works well, but that is not the only place. 

## Turning the Confidence Projector On and Off

The remote for the balcony projector (aka confidence projector) is usually found near the computer monitor.

## Centre Screen Operation

Note
: As of 2010 the centre projector is no longer in service.

Dropping the projection screen

There is a three way switch located near the floor below power switch #1.
The screen has automatic stops so you can't damage the screen by not stopping it soon enough.
The projector does not fill the entire screen so don't drop it all the way.

[Back to top](#top)

## Projector Manager
This section on the projector manager needs to be be re-written.

### Purpose

Projector Manager is used to manage the two side screen projectors from the computer. They can also be operated from the main floor via remote control.

### Operation

Once starting the program, you can turn the projectors on by right clicking on ‘Sanctuary sides’ and selecting ‘Turn On’, you will see their status change in the list to the right. To turn them off, follow the similar procedure. I recommend that you leave mediashout running with something on screen when turning the projectors off, that way you have a strong visual confirmation that they are off- because the screen goes blank.

Projectors can be operated individually by right clicking on just east or west. This can be useful if you just want to see how something looks – you don’t need both of them on.

Also when individually selected, advanced control functions are available on the control tab, but there is no need to change any of those settings for normal operation. Please consult with Terry before doing so.

### Trouble Shooting

Communication error
: Operation of Projector Manager is dependent on the church network which can sometimes cause problems. If the program cannot communicate with the projectors then you can still turn them on using the manual remote control. It is kept in the black cabinet in the audio storage room. You need to stand on the main floor in the area of the exit sign to work properly.

No video signal message
: Usual cause is that the red switch under the desk has not been turned on. It is possible that the wrong input is selected on the projector – the ‘RGB1’ input is the only one to be used.

Filter needs cleaning
: Please advise Terry.

[Back to top](#top)

## Operating the Video Switch

The easiest way to operate the presentation switch (Asset Tag ZVKU-A001) is from its web page. There should be a shortcut to it on the computer desktop, or use 
[this](`r NetworkInventory %>% filter(AssetTag == "ZVKU-A001" ) %>% select(URL)`).
On the page, click the output you want to change, and the input you want to tie it to. There is a little number in the output box which tells you which input it is tied to. The screen will go black for a few seconds while it makes the change.

You can do a similar thing direcly on the front panel using the OUT and IN buttons.  The unit is located under the desk near the computer.
```{r fig.height=2}
img <- readJPEG("../../images/sop-gear-vs88dt-1.jpg") 
  
g <- rasterGrob(img, interpolate=TRUE)

ggplot() +  
  annotation_custom(g, xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf)  +
  ggtitle("Matrix Video Switch", subtitle="Front Panel")
```
[Back to top](#top)

# Troubleshooting

## Projector screens are Red

The problem: 

* the Datapath fx4 has a problem. It outputs solid red if it has a incompatible configuration.
* This can be verified by switching a projector to an alternate video source (via matrix)

Recover steps:

* turn the fx4 off an on again.

Alternate:

* go to the video matrix and change the routing of output 1, 2 and 3 to come from the confidence display. 
* change the Propresenter stage display settings to be the primary output.

## Projectors show only grey (which is actually the secondary monitor bg colour)

The problem:

* Propresenter is confused
* This can be verified by opening “System Preferences” and select “Displays”. The displays dialog should appear on the projectors.

Recovery:

* Restart Propresenter
* If that doesn’t work, verify the the display settings in Propresenter Preferences. Sometimes it helps to drag stage display onto output once or twice until things are correct again. 

## Video mixer (ATEM) sees only a black image for the Propresenter input

The problem:

* The data path fx4 is not producing a compatible signal.

Recovery:

* Option A:
    * Turn the data path off and on again (Haven’t actually test this to see if it is effective, yet)
* Option B:
    * On a Web browser, go to the fx4 web page http://192.168.0.192 
    * Select Wall Designer
    * click the open icon on the right side.
    * Navigate to … Dropbox/UAC_Software/DatapathFX4/2017-12-27 sw.wdl (or a more recent file in the same location)
    * Go to the devices tab, right click on the fx4 graphic, select assign, enter the ip address (192168.0.192) and then apply settings button on the left hand side.
    * All projectors will be disrupted for about 20 seconds when you do this.
    * Propresenter may need to be restarted.

Alternate:
* No easy alternate.

## Projectors don’t respond to the web page request (to turn on or off)

The problem:

* network trouble
Recovery:

* Use the grey Sony remote controls to turn them on.
* You need to be pretty much directly below each projection screen and point the remote at the projector. One remote will do all three but have the change the selector switch for each projector (not sure if the switch is labelled 1,2,3 or A,B,C.) The east screen is the “first” ( A or 1).


# Appendix

## Video Terminology
 
[Back to top](#top)

## Lyrics using Mediashout

[This write up is based on Mediashout version 4.5.]

MediaShout (MS) is the name of the software program used at Unionville Alliance to show song words, Bible quotes, sermon content, videos and other visual and audio clips during service. These notes are intended to provide key learning points for Creative Arts team members tasked with the responsibility of running MediaShout during service or any other special events at UAC.

### Creating a service package

Early in the week the service cue sheet for the following Sunday will be distributed. With that in hand you can prepare the Mediashout script which needs to include all announcements, song lyrics, and other support elements. 

### Starting MediaShout

An icon for MediaShout is located on the left side of desktop of the balcony computer. The program can also be opened from the Windows program menu. Typically MS will open on the current week’s service, with all of the songs, sermon visuals etc. already set up. Do not make any changes to the setup unless absolutely necessary. Before making any changes it is a good precaution to save the original setup under a different filename, just in case you need to restore it (go to File/Save in the main menu at the top left of the MS screen; make sure to save the file in the current Sunday’s folder or somewhere else that you can easily find it if need be).

Each service package is saved in a folder based on the date of the current Sunday service or the name/date of any special event (e.g. Christmas Eve, Crank It Up etc.). If for some reason the program does not open on the current Sunday or special event, click File/Open in the top left corner and search the list of folders that opens and locate the one corresponding to the current date. Within that folder you will see the MS icon, double click on it and the service package for the current date will load.

The main MS screen contains multiple rows, each row can be one of several different types, such as:

* A Section
* A Comment (orange)
* Script Controls (blue)
* or audio-visual components, such as song words, sermon slides or background slides.

### Checking the MS setup against the cue sheet

When MS opens the user will see various headings, song verses and other visuals already created by the UAC office staff. The sequence of headings, songs etc. should match that of the cue sheet. The user should first of all go through the cue sheet and the current service package and make absolutely sure that the two match. Pay particular attention to any special content such as video or audio clips and make certain that these have been set up and are where they are supposed to be. If there any discrepancies are discovered, discuss them with the worship leader.

If any special contents (e.g. video clip etc.) are missing the go to File/Open and search for them in the folder for the current Sunday service or other event. If you are unable to locate them, ask for assistance. To move content around in the main MS screen simply click and drag the row(s) containing the content; for instance to move a video clip to a different row location in the service package.

### Testing special content such as video or audio clips

As soon as possible test all special content, ideally before rehearsals commence; don’t leave it to the last minute. Let the sound person know that you are going to test a special clip so that they can ensure that the audio is working fine (there is usually is, but not always, audio as part of a video clip). Double click on the video/audio clip to play it. The file will start immediately; please note that a single click will not start a video/audio clip, you must double click it. To check on the length and progress of the clip look towards the bottom left of the MS screen. You will see a set of player controls as well as a slider all of which become active once a video/audio clip is being played. The amount of time in hours:minutes:seconds that the clip has been playing is shown to the left of the slider; remaining time is shown to the right of the slider.

When testing the audio/video clip pay special attention to how it starts and ends. Some clips have a quiet start or begin with a black screen. Make sure that you are familiar with this before service starts, so that you don’t become confused during service as to whether the clip is playing or not.

 > Quick Tip: You can manually move the slider to jump to different location in the clip if need be; before doing so be sure that you know where you want to jump to, by having tested the clip beforehand and writing down the time reference for where you want the clip to start if not from the start. If you need to restart a video clip simply drag the slider all the way to the left and click the blue play arrow located among the a/v controls to the left of the slider.

Running MS

Hitting the space bar is the most convenient and quickest means of moving from one element to another within MS as service progress. You can also use the mouse and/or arrow keys. Press the space bar to move from one verse/sermon slide to another.

> Quick Tip: To help the congregation read along and keep time with a song or Bible quote, hit the spacebar to advance to the next verse etc. at the third or second last word of the current verse, so that the next one will be displayed on the screen just before the worship team starts to sing it; doing this will ensure that the congregation won’t be left waiting for the words to the next verse to appear on the screen once the worship team starts to sing it.

 As noted above, the exception to using the space bar is when starting a video or audio clip. To start the latter double click on the row containing the video/audio item; there may be a lead in (e.g. black screen, quiet lead-in); don’t double click again, instead look at the bottom left corner for the audio/video controls and slider (see above) to confirm if the clip has started. And always test all audio/video clips during rehearsals before service begins.

To add new content, such as a Bible quote, text, song or video etc. right click on the row where you want to place it in the main MS screen, and click on ‘Insert’ from the menu that pops up; after clicking on ‘Insert’ you will see a list of the various different types of audio/visual elements or cues that you can add; e.g. to insert a new song select ‘Lyric’. A new screen will then pop up in which you can type the title of the song in a search box at the top left and press enter; a list of matching song titles from the song database will be shown below the search box, to pick one click it then hit the Add button (green plus sign) ; on the right is an area where you preview the song lyrics to ensure that you have chosen the correct version; once you have verified that you have the right song (sometimes there are several songs in the database with the same or similar titles, if so ask the worship team leader to confirm which version they want or verify them against the printed song words which are usually provided to the MS operator before each service) then hit the Select button and the song will be added to the current service package. It will show up as one of the rows in the main MS window, you can then edit it as need be (see below), for instance to change the background or font size/type.

PowerPoint presentations can also be added to the script. It is just another kind of content that can be Inserted. Again using the 'Insert' menu as above, select the 'Slideshow' option and then navigate to the place on the hard drive where the PowerPoint file has been stored. We don't recommend running a presentation from a CD or a USB stick. Always copy them to the hard drive.

### Using the Viewer screens

The Viewer screens allow the operator to see what the current verse etc. looks like on the screen as well as preview the next one. If these are not visible along the right hand side, go to the 'View' menu, select 'Workspace' and then 'Standard'.. There are buttons below each viewer screen that allow you to change what each displays. A typical scenario would be to show the 'program' in Viewer 1, and Next in Viewer 2. 

### Editing the contents of the service package

To edit an existing song or other element in the service package right click on it and select ‘Edit Cue’ from the dialogue that pops up.  A new screen then opens containing multiple tabs such as 'Cue', 'Foreground', 'Background', etc. The default is the Cue tab. You will probably use the 'Foreground' tab most often. The Foreground tab contains multiple options by which you can change all of the text settings in a song, as well as add new verses etc. and rearrange the order in which verses will show on the screen.

 > Quick Tip: The Text Style button at the top next to the song name allows you to change all the text settings for the entire song etc. in one place.

 > Quick Tip: Put a border/outline and shadow around words to make it easier for the congregation to see them. To do so, click the ‘fx’ button just above the text window in the middle of the Foreground tab and then edit the outline and shadow settings from the dialogue which pops up.You do have to have the 'cue' item selected in the left hand window rather than an individual verse. Outlines are useful when the word colouring easily bleeds into the background image.

The lower left section of the Foreground tab allows you to add/remove verses and change the play order. The section at the left of the foreground tab shows all of the verses, choruses etc. contained in the song. You can click and drag theseup or down to create the order in which the verses will be actually shown during service. You can drag the verses within the white area. You can use the plus or minus buttons to add/remove verses from the song contents into the play order.

Along the bottom of the Edit Cue dialogue are buttons for 'Play Cue', 'OK', 'Apply, and 'Cancel'. 
Play Cue: Immediate shows the audience the more recent edits of which ever verse you have selected - useful if you are correctly a typo on the fly our you want to see how the text will look on the screen during preparation.
Ok: Applies your changes and takes you back to the script.
Apply: Applies your changes but and allows you to make further edits.
Cancel: Abandons your edits.
The Background tab allows you to change the background by using the drop down list on the left of the window. A list of backgrounds will display when you select the drop down list; from there you can also search for backgrounds in other folders too. Usually you will want to inherit from Cue and control the background for the entire song from the Cue tab.

The Soundtrack tab enables the operator to control any audio that might be present (e.g. a background slide might have an embedded music track which would play as soon as the slide is clicked). For instance you can set the audio to loop continuously instead of just playing once.

### Getting help while using MediaShout

For short immediate help tips within the MS program itself, go to Window in the main menu at the top of the screen and select Help, and then help topics. 

### Learning more about MediaShout

MS is a flexible, powerful program. This tutorial has just touched on some of the key elements specific to how we use MS at UAC; there’s a lot more to learn especially for someone who wants to become very proficient in using the software. They have many useful tutorial videos available on Youtube: http://www.youtube.com/user/MediaComplete

[Back to top](#top)

`r knit_child('FurtherInformation.Rmd', quiet=TRUE)`

[Back to top](#top)

# Document Source
This document is compiled by merging text and data together using rmarkdown. The source is found here `r paste0(getwd(),  "/", knitr::current_input())`.